<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://java.sun.com/jsf/html"
      xmlns:f="http://java.sun.com/jsf/core"
      xmlns:ui="http://java.sun.com/jsf/facelets"
      xmlns:p="http://primefaces.org/ui"
      xmlns:pe="http://primefaces.org/ui/extensions">

    <ui:composition template="/templates/page-template_pf_con_datos_usuario.xhtml">
        <ui:define name="title">
            <h:outputText value="Actualización de Datos"/>
        </ui:define>

        <ui:define name="content">
            <h:form id="form">

                <p:growl id="growl" showDetail="true" showSummary="false" life="8000" autoUpdate="true"/>
                <h:panelGrid columns="2">
                    <p:outputLabel value="&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;
                                   &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;
                                   &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;
                                   &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;
                                   &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;
                                   &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;
                                   &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;
                                   &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;
                                   &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;
                                   &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;
                                   &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;" style="width: 80%"/>
                    <h:panelGroup style="text-align: right; right: -93%;">
                        <h:commandLink action="index?faces-redirect=true" title="Volver" styleClass="boton_salir" immediate="true">
                            <h:panelGrid style="text-align:center">
                                <h:graphicImage value="resources/images/back57.png" title="Volver" style="width: 50px; height: 50px"/>
                                <h:outputText value="Volver"/>
                            </h:panelGrid>
                        </h:commandLink>
                    </h:panelGroup>
                </h:panelGrid>
                <h2 class="titulo_centrado" style="width: 54.8%;position: relative;right: -308px;">GENERACIÓN DE REPORTES</h2>
                <p:panelGrid columns="2" styleClass="panel_grid_center" columnClasses="form-label-width, form-input">
                    <f:facet name="header">
                        <h:panelGroup style="display:block; text-align:center">
                            <p:outputLabel value="GENERACION DE REPORTES"/>
                        </h:panelGroup>
                    </f:facet>
                    <p:outputLabel value="Tipo de Reporte:"></p:outputLabel>
                    <p:selectOneMenu id="codigoTipoMineria"
                                     value="#{reporteCtrl.codigoTipoMineria}" 
                                     required="true" 
                                     requiredMessage="Tipo de reporte es requerido" 
                                     style="width: 93%">
                        <f:selectItem itemValue="" itemLabel="--Seleccione una opción--" />
                        <f:selectItems value="#{reporteCtrl.tipoSolicitudes}" />
                        <p:ajax listener="#{reporteCtrl.listenerTipoReporte()}" update="panelFiltros botones"/>
                    </p:selectOneMenu>
                </p:panelGrid>
                <p:panelGrid id="panelFiltros" columns="2" styleClass="panel_grid_center" columnClasses="form-label-width, form-input">
                    <p:outputLabel value="Fecha Desde:" rendered="#{reporteCtrl.mostrarFiltroFecha}"/>
                    <p:calendar placeholder="aaaa-mm-dd" navigator="true"
                                value="#{reporteCtrl.fechaDesdeFiltro}"  
                                locale="es" pattern="yyyy-MM-dd"  
                                effect="fold" 
                                style="width: 93%" 
                                required="true"
                                requiredMessage="Fecha Desde requerida"
                                rendered="#{reporteCtrl.mostrarFiltroFecha}"/>
                    <p:outputLabel value="Fecha Hasta:" rendered="#{reporteCtrl.mostrarFiltroFecha}"/>
                    <p:calendar placeholder="aaaa-mm-dd" navigator="true"
                                value="#{reporteCtrl.fechaHastaFiltro}"  
                                locale="es" pattern="yyyy-MM-dd" 
                                effect="fold" 
                                style="width: 93%" 
                                required="true"
                                requiredMessage="Fecha Hasta requerida"
                                rendered="#{reporteCtrl.mostrarFiltroFecha}"/>
                    <p:outputLabel value="Regional:" rendered="#{reporteCtrl.mostrarFiltroRegional}"/>
                    <p:selectOneMenu value="#{reporteCtrl.prefijoRegionalFiltro}" 
                                     required="true" 
                                     requiredMessage="Regional es requerido" 
                                     style="width: 93%"
                                     rendered="#{reporteCtrl.mostrarFiltroRegional}">
                        <f:selectItem itemValue="" itemLabel="--Seleccione una opción--" />
                        <f:selectItems value="#{reporteCtrl.regionales}" />
                    </p:selectOneMenu>
                    
                    <p:outputLabel value="Subtipo Reporte:" rendered="#{reporteCtrl.mostrarSubTipoReporteOperativo}"/>
                    <p:selectOneMenu value="#{reporteCtrl.codigoSubTipoOperativo}"
                                     required="true"
                                     requiredMessage="Subtipo reporte operativo es requerido"
                                     style="width: 93%"
                                     rendered="#{reporteCtrl.mostrarSubTipoReporteOperativo}">
                        <f:selectItem itemValue="" itemLabel="--Seleccione una opción--" />
                        <f:selectItems value="#{reporteCtrl.subTiposOperativo}"/>
                        <p:ajax listener="#{reporteCtrl.listenerSubTipoOperativo()}" update="panelFiltros botones"/>
                    </p:selectOneMenu>
                    
                    <p:outputLabel value="Año:" rendered="#{reporteCtrl.mostrarFiltroAnio}"/>
                    <p:selectOneMenu value="#{reporteCtrl.anioOperativo}"
                                     required="true"
                                     requiredMessage="Año es requerido"
                                     style="width: 93%"
                                     rendered="#{reporteCtrl.mostrarFiltroAnio}">
                        <f:selectItem itemValue="" itemLabel="--Seleccione una opción--" />
                        <f:selectItems value="#{reporteCtrl.aniosOperativo}"/>
                    </p:selectOneMenu>
                    
                    <f:facet name="footer">
                        <h:panelGroup id="botones" style="display:block; text-align:center">
                            <h:commandButton value="Generar" 
                                             actionListener="#{reporteCtrl.generarReporte}" 
                                             rendered="#{!(reporteCtrl.codigoTipoMineria == 10003 or 
                                                         reporteCtrl.codigoTipoMineria == 100011 or
                                                         reporteCtrl.codigoTipoMineria == 100012 or
                                                         reporteCtrl.codigoTipoMineria == 100013 or 
                                                         reporteCtrl.codigoTipoMineria == 100014)}"/>
                            <p:commandButton update="@form"
                                             value="Generar"
                                             title="Comprobante" 
                                             oncomplete="PF('visorTramite').show();return false;"
                                             actionListener="#{reporteCtrl.generarReporte}"
                                             rendered="#{reporteCtrl.codigoTipoMineria == 10003 or 
                                                         reporteCtrl.codigoTipoMineria == 100011 or
                                                         reporteCtrl.codigoTipoMineria == 100012 or
                                                         reporteCtrl.codigoTipoMineria == 100013 or
                                                         reporteCtrl.codigoTipoMineria == 100014}"/>
                            <p:commandButton value="Cancelar" action="index.xhtml?faces-redirect=true" immediate="true"/>
                        </h:panelGroup>
                    </f:facet>
                </p:panelGrid>                
                <p:dialog id="dialoVisorTareas" header="Comprobante" 
                          widgetVar="visorTramite" width="95%" height="600px"  
                          showEffect="fade" draggable="false" 
                          resizable="false" modal="true" >
                    <iframe frameborder="0"
                            src="#{reporteCtrl.urlReporte}"
                            name="frameTareas" id="frameTareas" scrolling="auto" 
                            width="100%" height="98%" 
                                    marginheight="0" marginwidth="0">
                    </iframe>
                </p:dialog>
                <p:dialog id="dialoVisorRptCN" header="Reporte Catastro Nacional" widgetVar="visorRptCatastroNacional" width="95%" height="400px"  
                          showEffect="fade" draggable="false" 
                          resizable="false" modal="true" >
                    <h:commandLink styleClass="lnkexport" id="idBoton">
                        <h:graphicImage value="resources/images/msexcel.png" width="16"/>
                        <h:outputLabel value="&#160;Exportar Reporte"/>
                        <p:dataExporter type="xls" target="dtDatosReporte" fileName="CatastroNacional" />
                    </h:commandLink>
                    
                    <p:dataTable id="dtDatosReporte" var="reg" value="#{reporteCtrl.listaAreas}" rows="2" 
                                 paginator="true"
                                 currentPageReportTemplate="Mostrando {startRecord}-{endRecord} de {totalRecords}"
                                 paginatorTemplate="{CurrentPageReport} {FirstPageLink} {PreviousPageLink} {PageLinks} {NextPageLink} {LastPageLink} {RowsPerPageDropdown}"
                                 rowsPerPageTemplate="20,50,100" paginatorPosition="bottom" styleClass="texto_tabla_datos" rowIndexVar="rowIndex" emptyMessage="No existen registros" style="width: 100%">

                        <p:column headerText="codigo_solicitud" style="width: 85px; text-align: right">
                            <h:outputText  styleClass="texto_tabla_datos_codigo" value="#{reg.codigoConcesion}" />
                        </p:column>
                        <p:column headerText="codigo_arcom">
                            <h:outputText value="#{reg.codigoArcom}" />
                        </p:column>
                        <p:column headerText="nombre_concesion">
                            <h:outputText value="#{reg.nombreConcesion}" />
                        </p:column>
                        <p:column headerText="titular_documento">
                            <h:outputText value="#{reg.titularDocumento}" />
                        </p:column>
                        <p:column headerText="titular_nombre">
                            <h:outputText value="#{reg.titularNombre}" />
                        </p:column>
                        <p:column headerText="telefono">
                            <h:outputText value="#{reg.telefono}" />
                        </p:column>
                        <p:column headerText="direccion">
                            <h:outputText value="#{reg.direccion}" />
                        </p:column>
                        <p:column headerText="rep_legal_documento">
                            <h:outputText value="#{reg.repLegalNombre}" />
                        </p:column>
                        <p:column headerText="rep_legal_nombre">
                            <h:outputText value="#{reg.repLegalDocumento}" />
                        </p:column>
                        <p:column headerText="casillero_judicial">
                            <h:outputText value="#{reg.casilleroJudicial}" />
                        </p:column>
                        <p:column headerText="plazo_concesion">
                            <h:outputText value="#{reg.plazoConcesion}" />
                        </p:column>
                        <p:column headerText="plazo_dias">
                            <h:outputText value="#{reg.plazoDias}" />
                        </p:column>
                        <p:column headerText="fase">
                            <h:outputText value="#{reg.fase}" />
                        </p:column>
                        <p:column headerText="tipo_solicitud">
                            <h:outputText value="#{reg.tipoSolicitud}" />
                        </p:column>
                        <p:column headerText="fecha_otorgamiento">
                            <h:outputText value="#{reg.fechaOtorgamiento}" >
                                <f:convertDateTime pattern="yyyy-MM-dd"/>
                            </h:outputText>
                        </p:column>
                        <p:column headerText="fecha_inscripcion">
                            <h:outputText value="#{reg.fechaInscripcion}" >
                                <f:convertDateTime pattern="yyyy-MM-dd"/>
                            </h:outputText>
                        </p:column>
                        <p:column headerText="fecha_sustitucion">
                            <h:outputText value="#{reg.fechaSustitucion}" >
                                <f:convertDateTime pattern="yyyy-MM-dd"/>
                            </h:outputText>
                        </p:column>
                        <p:column headerText="fecha_inscripcion_sustitucion">
                            <h:outputText value="#{reg.fechaInscripcionSustitucion}" >
                                <f:convertDateTime pattern="yyyy-MM-dd"/>
                            </h:outputText>
                        </p:column>
                        <p:column headerText="estado_concesion">
                            <h:outputText value="#{reg.estadoConcesion}" />
                        </p:column>
                        <p:column headerText="nombre_regional">
                            <h:outputText value="#{reg.nombreRegional}" />
                        </p:column>
                        <p:column headerText="codigo_provincia">
                            <h:outputText value="#{reg.codigoProvincia}" />
                        </p:column>
                        <p:column headerText="provincia">
                            <h:outputText value="#{reg.provincia}" />
                        </p:column>
                        <p:column headerText="codigo_canton">
                            <h:outputText value="#{reg.codigoCanton}" />
                        </p:column>
                        <p:column headerText="canton">
                            <h:outputText value="#{reg.canton}" />
                        </p:column>
                        <p:column headerText="codigo_parroquia">
                            <h:outputText value="#{reg.codigoParroquia}" />
                        </p:column>
                        <p:column headerText="parroquia">
                            <h:outputText value="#{reg.parroquia}" />
                        </p:column>
                        <p:column headerText="zona">
                            <h:outputText value="#{reg.zona}" />
                        </p:column>
                        <p:column headerText="material_interes">
                            <h:outputText value="#{reg.materialInteres}" />
                        </p:column>
                        <p:column headerText="mineral">
                            <h:outputText value="#{reg.mineral}" />
                        </p:column>
                        <p:column headerText="superficie">
                            <h:outputText value="#{reg.superficie}" />
                        </p:column>
                        <p:column headerText="fecha_creacion">
                            <h:outputText value="#{reg.fechaCreacion}" >
                                <f:convertDateTime pattern="yyyy-MM-dd"/>
                            </h:outputText>
                        </p:column>
                        <p:column headerText="regimen">
                            <h:outputText value="#{reg.regimen}" />
                        </p:column>
                        <p:column headerText="modalidad_trabajo">
                            <h:outputText value="#{reg.modalidadTrabajo}" />
                        </p:column>
                        <p:column headerText="forma_explotacion">
                            <h:outputText value="#{reg.formaExplotacion}" />
                        </p:column>
                        <p:column headerText="volumen_diario_explotacion">
                            <h:outputText value="#{reg.volumenDiarioExplotacion}" />
                        </p:column>
                        <p:column headerText="volumen_total_explotacion">
                            <h:outputText value="#{reg.volumenTotalExplotacion}" />
                        </p:column>
                        <p:column headerText="litispendencia">
                            <h:outputText value="#{reg.litispendencia}" />
                        </p:column>

                    </p:dataTable>
                </p:dialog>
            </h:form>
        </ui:define>
    </ui:composition>
</html>

